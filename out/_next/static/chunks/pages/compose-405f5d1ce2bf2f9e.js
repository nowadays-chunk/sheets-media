(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2676],{29007:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/compose",function(){return n(44620)}])},44620:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>eb});var i=n(37876),l=n(14232),r=n(55471),s=n(55751),o=n(65754),a=n(87080),d=n(60230),c=n(38102);class u{static generate(e){let t=e.measures.map((e,t)=>({measure:{"@_number":t+1,note:e.voices[0].elements.map(e=>e.note.pitch?u.noteXML(e.note):u.restXML(e.note))}})),n={"score-partwise":{"@_version":"3.1","movement-title":e.title,part:{"@_id":"P1",measure:t.map(e=>e.measure)}}};return new c.A({ignoreAttributes:!1,format:!0}).build(n)}static noteXML(e){return{pitch:{step:e.pitch.step,alter:e.pitch.accidental,octave:e.pitch.octave},duration:Math.round(256*e.duration.total),voice:1,type:u.durationToType(e.duration.total)}}static restXML(e){return{rest:{},duration:Math.round(256*e.duration.total),voice:1,type:u.durationToType(e.duration.total)}}static durationToType(e){return({4:"whole",2:"half",1:"quarter",.5:"eighth",.25:"16th"})[e]||"quarter"}}var h=n(56062),x=n(28044),f=n(37610),m=n(12700),p=n(59100);class A{serialize(){return{duration:this.duration.serialize()}}static deserialize(e){return new A(p.A.deserialize(e.duration))}clone(){return new A(this.duration.clone())}constructor(e=new p.A("q")){this.duration=e}}var j=n(61302),b=n(35007),g=n(73173);class v{static parse(e){let t=new DOMParser().parseFromString(e,"application/xml"),n=new h.A,i=t.querySelector("movement-title");i&&(n.title=i.textContent);let l=t.querySelector("key > fifths");l&&(n.keySignature=new b.A({"-7":"Cb","-6":"Gb","-5":"Db","-4":"Ab","-3":"Eb","-2":"Bb","-1":"F",0:"C",1:"G",2:"D",3:"A",4:"E",5:"B",6:"F#",7:"C#"}[l.textContent]||"C"));let r=t.querySelector("time > beats"),s=t.querySelector("time > beat-type");return r&&s&&(n.timeSignature=new g.A(parseInt(r.textContent),parseInt(s.textContent))),n.measures=[],t.querySelectorAll("measure").forEach((e,t)=>{let i=new x.A({index:t,timeSignature:n.timeSignature}),l=new f.A(0);e.querySelectorAll("note").forEach(e=>{let t=e.querySelector("rest"),n=e.querySelector("duration"),i=parseInt((null==n?void 0:n.textContent)||1)/256;if(t)l.addRest(new A(new p.A(i)));else{var r;let t=e.querySelector("pitch > step").textContent,n=parseInt(e.querySelector("pitch > octave").textContent),s=parseInt((null==(r=e.querySelector("pitch > alter"))?void 0:r.textContent)||0),o=new j.A(t,s,n);l.addNote(new m.A({pitch:o,duration:new p.A(i)}))}}),i.voices=[l],n.measures.push(i)}),n}}var y=n(90570);class w{static parse(e){var t;let n=new y.Midi(e),i=new h.A;n.header.timeSignatures.length>0&&(n.header.timeSignatures[0].timeSignature[0],n.header.timeSignatures[0].timeSignature[1]);let l=(null==(t=n.header.tempos[0])?void 0:t.bpm)||120,r=n.tracks.find(e=>e.notes.length>0);if(!r)return i;let s=r.notes.map(e=>({beat:e.time*(l/60),duration:e.duration*(l/60),midi:e.midi}));s.sort((e,t)=>e.beat-t.beat);let o=0,a=[];s.forEach(e=>{let t=.25*Math.round(e.beat/.25),n=.25*Math.round(e.duration/.25);n<.25&&(n=.25);let i=a.find(e=>.01>Math.abs(e.beat-t));i||(i={beat:t,notes:[],duration:n},a.push(i)),i.notes.push(e)}),a.sort((e,t)=>e.beat-t.beat);for(let e=0;e<a.length;e++){let t=a[e],n=a[e+1];if(t.beat>o+.01){let e=t.beat-o;(function(e,t,n){let i=t;C(n).forEach(t=>{let n=p.A.toBeats(t),l=new m.A(new j.A("B",0,4),new p.A(t));l.isRest=!0,e.addNote(i,l),i+=n})})(i,o,e),o=t.beat}let l=t.duration;n&&t.beat+l>n.beat&&(l=n.beat-t.beat),t.notes.forEach(e=>{let t=j.A.fromMidi(e.midi),n=C(l)[0],r=new m.A(t,new p.A(n)),s=function(e){let t=[64,59,55,50,45,40];for(let n=0;n<t.length;n++){let i=e-t[n];if(i>=0&&i<=4)return{string:n+1,fret:i}}for(let n=0;n<t.length;n++){let i=e-t[n];if(i>=0&&i<=12)return{string:n+1,fret:i}}for(let n=0;n<t.length;n++){let i=e-t[n];if(i>=0)return{string:n+1,fret:i}}return{string:1,fret:0}}(e.midi);r.string=s.string,r.fret=s.fret,i.addNote(o,r)}),o+=p.A.toBeats(C(l)[0])}return i}}function C(e){let t=[],n=e;for(;n>=3.99;)t.push("w"),n-=4;for(;n>=1.99;)t.push("h"),n-=2;for(;n>=.99;)t.push("q"),n-=1;for(;n>=.49;)t.push("8"),n-=.5;for(;n>=.24;)t.push("16"),n-=.25;return 0===t.length&&t.push("16"),t}var S=n(37309);class k{static generate(e){let t=[],n=0,i=0;return e.measures.forEach(e=>{e.voices.forEach(e=>{e.elements.forEach(e=>{if(!e.duration)return;let l=480*e.duration.total;e.pitch&&(t.push({deltaTime:i-n,type:"noteOn",noteNumber:e.pitch.midi,velocity:80}),t.push({deltaTime:l,type:"noteOff",noteNumber:e.pitch.midi,velocity:0}),n=i+l),i+=l})})}),new Blob([(0,S.writeMidi)({header:{format:0,numTracks:1,ticksPerBeat:480},tracks:[t]})],{type:"audio/midi"})}}class E{static saveXML(e){let t=u.generate(e);E._download(t,"score.musicxml","text/xml")}static saveMIDI(e){let t=k.generate(e);E._download(t,"score.mid","audio/midi")}static loadXML(e,t){let n=new FileReader;n.onload=()=>{t(v.parse(n.result))},n.readAsText(e)}static loadMIDI(e,t){let n=new FileReader;n.onload=()=>{t(w.parse(n.result))},n.readAsArrayBuffer(e)}static _download(e,t,n){let i=e instanceof Blob?e:new Blob([e],{type:n}),l=URL.createObjectURL(i),r=document.createElement("a");r.href=l,r.download=t,r.click()}}function T(){let{score:e,setScore:t}=(0,r.QG)(),[n,s]=l.useState(null);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.A,{onClick:e=>s(e.currentTarget),children:"File"}),(0,i.jsxs)(a.A,{open:!!n,anchorEl:n,onClose:()=>s(null),children:[(0,i.jsx)(d.A,{onClick:()=>{E.saveXML(e),s(null)},children:"Export MusicXML"}),(0,i.jsx)(d.A,{onClick:()=>{E.saveMIDI(e),s(null)},children:"Export MIDI"}),(0,i.jsx)(d.A,{onClick:()=>{document.getElementById("midi-upload").click(),s(null)},children:"Import MIDI"})]}),(0,i.jsx)("input",{type:"file",id:"midi-upload",accept:".mid,.midi",style:{display:"none"},onChange:e=>{let n=e.target.files[0];n&&E.loadMIDI(n,e=>{t(e)}),e.target.value=""}})]})}function I(){let{undoAction:e,redoAction:t}=(0,r.QG)(),[n,c]=(0,l.useState)(null);return(0,i.jsxs)(s.A,{sx:{position:"fixed",top:65,left:0,right:0,display:"flex",gap:2,padding:1,borderBottom:"1px solid #ddd",background:"#eee",zIndex:1100},children:[(0,i.jsx)(T,{}),(0,i.jsx)(o.A,{onClick:e=>c(e.currentTarget),children:"Edit"}),(0,i.jsxs)(a.A,{anchorEl:n,open:!!n,onClose:()=>c(null),children:[(0,i.jsx)(d.A,{onClick:()=>{e(),c(null)},children:"Undo"}),(0,i.jsx)(d.A,{onClick:()=>{t(),c(null)},children:"Redo"})]}),(0,i.jsx)(o.A,{disabled:!0,children:"View"}),(0,i.jsx)(o.A,{disabled:!0,children:"Help"})]})}var M=n(50993),R=n(71733),_=n(7579),q=n(51750),B=n(54915),z=n(56057),F=n(36307),D=n(43130),L=n(86695),N=n(74879);function G(){var e,t,n,o,a;let{input:d,selection:c,updateScore:u,cursorBeat:h,setCursorBeat:x,insertNoteFromStringFret:f}=(0,r.QG)(),[,A]=(0,l.useState)({}),[b,g]=(0,l.useState)(1),[v,y]=(0,l.useState)(0),[w,C]=(0,l.useState)((null==(e=d.activeDuration)?void 0:e.symbol)||"q"),[S,k]=(0,l.useState)(null);(0,l.useEffect)(()=>(k(c.selected),c.subscribe(k)),[c]);let E=e=>{let t=c.selected;t&&u(n=>{for(let i of n.measures)for(let n of i.voices){let i=n.elements.find(e=>e.note.id===t.id);if(i){i.note.technique=e,"bend"!==e||i.note.bend||(i.note.bend="Full");return}}})},T=(e,t)=>{let n=w===e,l=S&&S.duration&&S.duration.symbol===e;return(0,i.jsx)(M.A,{title:"".concat(e," note"),children:(0,i.jsx)(R.A,{onClick:()=>{C(e),d.setDuration(e)},color:n||l?"primary":"default",sx:{fontSize:14,fontWeight:"bold",width:36,height:36,border:n||l?"2px solid":"1px solid #eee",borderColor:n||l?"primary.main":"#eee"},children:t})})};return(0,i.jsxs)(s.A,{sx:{position:"fixed",top:105,left:0,right:0,display:"flex",gap:1,padding:1,borderBottom:"1px solid #ddd",background:"#fafafa",zIndex:1100,overflowX:"auto"},children:[(0,i.jsx)(M.A,{title:"Select tool",children:(0,i.jsx)(R.A,{children:(0,i.jsx)(q.A,{})})}),(0,i.jsx)(M.A,{title:"Move Left",children:(0,i.jsx)(R.A,{onClick:()=>window.dispatchEvent(new CustomEvent("editor:move-cursor",{detail:-1})),children:(0,i.jsx)(B.A,{})})}),(0,i.jsx)(M.A,{title:"Move Right",children:(0,i.jsx)(R.A,{onClick:()=>window.dispatchEvent(new CustomEvent("editor:move-cursor",{detail:1})),children:(0,i.jsx)(z.A,{})})}),T("w","W")," ",T("h","H")," ",T("q","Q")," ",T("8","8")," ",T("16","16"),(0,i.jsx)(M.A,{title:"Rest",children:(0,i.jsx)(R.A,{onClick:()=>{let e=d.activeDuration||new p.A("q"),t=new m.A(new j.A("B",0,4),e);t.isRest=!0,u(e=>{e.addNote(h,t)}),x(e=>e+1)},sx:{fontSize:14,fontWeight:"bold",width:36,height:36,border:"1px solid #eee"},children:"R"})}),(0,i.jsx)(_.A,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),["C","D","E","F","G","A","B"].map(e=>(0,i.jsx)(M.A,{title:"Insert ".concat(e),children:(0,i.jsx)(R.A,{onClick:()=>(e=>{let t=new j.A(e,d.activeAccidental,4),n=d.activeDuration||new p.A("q"),i=new m.A(t,n);i.velocity=.9,u(e=>{e.addNote(h,i)}),x(e=>e+1)})(e),sx:{width:36,height:36,fontSize:14,fontWeight:"bold",border:"1px solid #eee"},children:e})},e)),(0,i.jsx)(_.A,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),(0,i.jsx)(M.A,{title:"Sharp (#)",children:(0,i.jsx)(R.A,{onClick:()=>d.setAccidental(1),color:1===d.activeAccidental?"primary":"default",sx:{fontWeight:"bold",fontSize:18},children:"♯"})}),(0,i.jsx)(M.A,{title:"Flat (♭)",children:(0,i.jsx)(R.A,{onClick:()=>d.setAccidental(-1),color:-1===d.activeAccidental?"primary":"default",sx:{fontWeight:"bold",fontSize:18},children:"♭"})}),(0,i.jsx)(_.A,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),(0,i.jsx)(M.A,{title:"Slide",children:(0,i.jsx)(R.A,{onClick:()=>E("slide"),color:(null==(t=c.selected)?void 0:t.technique)==="slide"?"primary":"default",children:(0,i.jsx)(F.A,{})})}),(0,i.jsx)(M.A,{title:"Hammer-on",children:(0,i.jsx)(R.A,{onClick:()=>E("hammer"),color:(null==(n=c.selected)?void 0:n.technique)==="hammer"?"primary":"default",children:(0,i.jsx)(L.A,{})})}),(0,i.jsx)(M.A,{title:"Pull-off",children:(0,i.jsx)(R.A,{onClick:()=>E("pull"),color:(null==(o=c.selected)?void 0:o.technique)==="pull"?"primary":"default",children:(0,i.jsx)(D.A,{})})}),(0,i.jsx)(M.A,{title:"Bend",children:(0,i.jsx)(R.A,{onClick:()=>E("bend"),color:(null==(a=c.selected)?void 0:a.technique)==="bend"?"primary":"default",children:(0,i.jsx)(N.A,{})})}),(0,i.jsx)(_.A,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),(0,i.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,i.jsx)("input",{type:"number",min:"1",max:"6",value:b,onChange:e=>g(e.target.value),style:{width:40,padding:4,borderRadius:4,border:"1px solid #ccc"},placeholder:"Str",title:"String"}),(0,i.jsx)("input",{type:"number",min:"0",max:"24",value:v,onChange:e=>y(e.target.value),style:{width:40,padding:4,borderRadius:4,border:"1px solid #ccc"},placeholder:"Fret",title:"Fret"}),(0,i.jsx)(R.A,{onClick:()=>{f(parseInt(b),parseInt(v))},color:"primary",sx:{border:"1px solid #eee",borderRadius:1},children:(0,i.jsx)(s.A,{sx:{fontSize:12,fontWeight:"bold"},children:"TAB"})})]})]})}var W=n(11577),H=n(35294),P=n(40051),X=n(68169);function O(){let{playback:e,score:t}=(0,r.QG)(),[n,o]=(0,l.useState)(120);return e?(0,i.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",gap:2,padding:1,borderTop:"1px solid #ddd",borderBottom:"1px solid #ddd",background:"#fafafa",position:"fixed",top:155,left:0,right:0,zIndex:1100},children:[(0,i.jsx)(R.A,{onClick:()=>e.playScore(t),children:(0,i.jsx)(H.A,{})}),(0,i.jsx)(R.A,{onClick:()=>e.stop(),children:(0,i.jsx)(P.A,{})}),(0,i.jsx)(R.A,{onClick:()=>e.setLoop(0,4),children:(0,i.jsx)(X.A,{})}),(0,i.jsx)(W.Ay,{value:n,min:40,max:200,sx:{width:200},onChange:(t,n)=>{o(n),e.setTempo(n)}}),n," BPM"]}):(0,i.jsx)(s.A,{sx:{display:"flex",alignItems:"center",padding:1,borderBottom:"1px solid #ddd"},children:"Loading audio engine…"})}var V=n(35003),U=n(49576);function Q(){let{score:e,updateScore:t,selection:n,cursorBeat:c,setCursorBeat:u}=(0,r.QG)(),[h,x]=l.useState(null),[f,m]=l.useState(null),[p,A]=l.useState(null),[j,v]=l.useState(null),y=n.selected,w=e=>{t(t=>{t.clef=new U.A(e)}),x(null)},C=(e,n)=>{t(t=>{t.timeSignature=new g.A(e,n)}),m(null)},S=e=>{t(t=>{t.keySignature=new b.A(e)}),A(null)},k=e=>{if(!y||!y.pitch)return void v(null);t(t=>{let n=null;e:for(let e of t.measures)for(let t of e.voices){let e=t.elements.find(e=>e.note.id===y.id);if(e){n=e.note;break e}}n&&(n.articulations=n.articulations||[],n.articulations.push(e))}),v(null)};return(0,i.jsxs)(s.A,{sx:{width:220,borderRight:"1px solid #ddd",p:2,background:"#fafafa",overflowY:"auto",height:"100%"},children:[(0,i.jsx)(V.A,{variant:"h6",sx:{mb:2},children:"Palette"}),(0,i.jsx)(o.A,{fullWidth:!0,variant:"outlined",onClick:e=>x(e.currentTarget),children:"Change Clef"}),(0,i.jsxs)(a.A,{anchorEl:h,open:!!h,onClose:()=>x(null),children:[(0,i.jsx)(d.A,{onClick:()=>w("treble"),children:"Treble"}),(0,i.jsx)(d.A,{onClick:()=>w("bass"),children:"Bass"}),(0,i.jsx)(d.A,{onClick:()=>w("alto"),children:"Alto"}),(0,i.jsx)(d.A,{onClick:()=>w("tenor"),children:"Tenor"})]}),(0,i.jsx)(o.A,{fullWidth:!0,variant:"outlined",sx:{mt:1},onClick:e=>m(e.currentTarget),children:"Time Signature"}),(0,i.jsxs)(a.A,{anchorEl:f,open:!!f,onClose:()=>m(null),children:[(0,i.jsx)(d.A,{onClick:()=>C(4,4),children:"4/4"}),(0,i.jsx)(d.A,{onClick:()=>C(3,4),children:"3/4"}),(0,i.jsx)(d.A,{onClick:()=>C(6,8),children:"6/8"}),(0,i.jsx)(d.A,{onClick:()=>C(2,4),children:"2/4"})]}),(0,i.jsx)(o.A,{fullWidth:!0,variant:"outlined",sx:{mt:1},onClick:e=>A(e.currentTarget),children:"Key Signature"}),(0,i.jsxs)(a.A,{anchorEl:p,open:!!p,onClose:()=>A(null),children:[(0,i.jsx)(d.A,{onClick:()=>S("C"),children:"C / Am"}),(0,i.jsx)(d.A,{onClick:()=>S("G"),children:"G / Em"}),(0,i.jsx)(d.A,{onClick:()=>S("D"),children:"D / Bm"}),(0,i.jsx)(d.A,{onClick:()=>S("A"),children:"A / F#m"}),(0,i.jsx)(d.A,{onClick:()=>S("E"),children:"E / C#m"}),(0,i.jsx)(d.A,{onClick:()=>S("F"),children:"F / Dm"}),(0,i.jsx)(d.A,{onClick:()=>S("Bb"),children:"Bb / Gm"}),(0,i.jsx)(d.A,{onClick:()=>S("Eb"),children:"Eb / Cm"})]}),(0,i.jsx)(o.A,{fullWidth:!0,variant:"outlined",sx:{mt:1},onClick:e=>v(e.currentTarget),disabled:!y,children:"Articulations"}),(0,i.jsxs)(a.A,{anchorEl:j,open:!!j,onClose:()=>v(null),children:[(0,i.jsx)(d.A,{onClick:()=>k("staccato"),children:"Staccato"}),(0,i.jsx)(d.A,{onClick:()=>k("accent"),children:"Accent"}),(0,i.jsx)(d.A,{onClick:()=>k("tenuto"),children:"Tenuto"})]})]})}var Y=n(28836);let K=Y.Ay;class J{render(){if(!this.container||!this.score)return;this.container.innerHTML="";let e=new K.Renderer(this.container,K.Renderer.Backends.SVG);e.resize(900,1400);let t=e.getContext(),n=20+250*this.score.measures.length+100;e.resize(n,200);let i=20;this.score.measures.forEach((e,n)=>{let l=new K.Stave(i,40,250);if(0===n){var r;l.addClef((null==(r=this.score.clef)?void 0:r.name)||"treble").addTimeSignature(this.score.timeSignature.toString()).addKeySignature(this.score.keySignature.key)}l.setContext(t).draw();let s=[];e.voices.forEach(t=>{if(!t.elements.length)return;let n=new Map;t.elements.forEach(e=>{let t=e.beat;n.has(t)||n.set(t,[]),n.get(t).push(e.note)});let i=Array.from(n.keys()).sort((e,t)=>e-t),l=[];i.forEach(e=>{let t,i=n.get(e);if(!i||0===i.length)return;let r=i[0],s=(null==(o=r.duration)?void 0:o.symbol)||"q";if(r.isRest)t=new K.StaveNote({keys:["b/4"],duration:s+"r"});else{let e=i.map(e=>"".concat(e.pitch.step.toLowerCase()).concat(1===e.pitch.alter?"#":-1===e.pitch.alter?"b":2===e.pitch.alter?"##":-2===e.pitch.alter?"bb":"","/").concat(e.pitch.octave));var o,a,d=t=new K.StaveNote({keys:e,duration:s}),c=this.selection;let n=null==(a=d.getSVGElement)?void 0:a.call(d);n&&(n.style.cursor="pointer",n.addEventListener("click",e=>{e.stopPropagation(),c.select(r)}))}l.push(t)});let r=new K.Voice({num_beats:e.timeSignature.beats,beat_value:e.timeSignature.beatValue});r.setMode(K.Voice.Mode.SOFT),r.addTickables(l),s.push(r)}),s.length&&(new K.Formatter().joinVoices(s).format(s,230),s.forEach(e=>e.draw(t,l))),i+=250})}constructor({container:e,score:t,selection:n}){this.container=e,this.score=t,this.selection=n}}let Z=Y.Ay;class ${render(){if(!this.container||!this.score)return;this.container.innerHTML="";let e=new Z.Renderer(this.container,Z.Renderer.Backends.SVG);e.resize(900,1400);let t=e.getContext(),n=20+250*this.score.measures.length+100;e.resize(n,200);let i=20;this.score.measures.forEach((e,n)=>{let l=new Z.TabStave(i,40,250);0===n&&l.addClef("tab"),l.setContext(t).draw();let r=[],s=[];e.voices.forEach(t=>{if(!t.elements.length)return;let n=new Map;t.elements.forEach(e=>{let t=e.beat;n.has(t)||n.set(t,[]),n.get(t).push(e.note)});let i=Array.from(n.keys()).sort((e,t)=>e-t),l=[],o=[];i.forEach(e=>{let t,i=n.get(e);if(!i||0===i.length)return;let r=i[0],s=(null==(a=r.duration)?void 0:a.symbol)||"q";if(r.isRest)t=new Z.GhostNote({duration:s});else{let e=i.map(e=>({str:e.string||1,fret:e.fret||0}));t=new Z.TabNote({positions:e,duration:s}),i.forEach((e,n)=>{if("bend"===e.technique&&t.addModifier(new Z.Bend(e.bend||"Full"),n),["slide","hammer","pull"].includes(e.technique)){let i=new Z.Annotation({slide:"sl.",hammer:"H",pull:"P"}[e.technique]);i.setFont("Arial",10,"italic"),t.addModifier(i,n)}});var a,d,c=t,u=this.selection;let n=null==(d=c.getSVGElement)?void 0:d.call(c);n&&(n.style.cursor="pointer",n.addEventListener("click",e=>{e.stopPropagation(),u.select(r)}))}l.push(t),o.push({group:i,tabNote:t})}),o.forEach((e,t)=>{if(t>=o.length-1)return;let n=o[t+1];e.group.forEach((t,i)=>{if(["slide","hammer","pull"].includes(t.technique)){let l=n.group.findIndex(e=>e.string===t.string);if(-1!==l){let s,o={first_note:e.tabNote,last_note:n.tabNote,first_indices:[i],last_indices:[l]};"slide"===t.technique?s=new Z.TabSlide(o):"hammer"===t.technique?s=new Z.HammerOn(o):"pull"===t.technique&&(s=new Z.PullOff(o)),s&&r.push(s)}}})});let a=new Z.Voice({num_beats:e.timeSignature.beats,beat_value:e.timeSignature.beatValue});a.setMode(Z.Voice.Mode.SOFT),a.addTickables(l),s.push(a)}),s.length&&(new Z.Formatter().joinVoices(s).format(s,230),s.forEach(e=>e.draw(t,l)),r.forEach(e=>e.setContext(t).draw())),i+=250})}constructor({container:e,score:t,selection:n}){this.container=e,this.score=t,this.selection=n}}class ee{render(){this.score&&(this.notationContainer.innerHTML="",this.tabContainer.innerHTML="",new J({container:this.notationContainer,score:this.score,selection:this.selection}).render(),new $({container:this.tabContainer,score:this.score,selection:this.selection}).render())}constructor({notationContainer:e,tabContainer:t,score:n,selection:i}){this.notationContainer=e,this.tabContainer=t,this.score=n,this.selection=i}}let et={START_X:20,MEASURE_WIDTH:200,MEASURES_PER_LINE:4,SYSTEM_HEIGHT:{notation:120,tab:150},START_Y:40};function en(e){let{activeTab:t}=e,{playback:n,score:s}=(0,r.QG)(),[o,a]=(0,l.useState)(0),d=(0,l.useRef)(null);(0,l.useEffect)(()=>{if(n)return n.onBeat=e=>{a(e)},()=>{n.onBeat=null}},[n]);let c=s&&n&&n.isPlaying,u=0,h=0,x=0,f=4;if(c)for(let e=0;e<s.measures.length;e++){let t=s.measures[e].timeSignature.beats;if(o>=x&&o<x+t){u=e,h=o-x,f=t;break}x+=t}let m=Math.floor(u/et.MEASURES_PER_LINE),p=u%et.MEASURES_PER_LINE,A=et.START_X+p*et.MEASURE_WIDTH+h/f*(et.MEASURE_WIDTH-20)+15,j=et.START_Y+m*et.SYSTEM_HEIGHT[t];return((0,l.useEffect)(()=>{c&&d.current&&d.current.scrollIntoView({block:"center",behavior:"smooth"})},[m,c]),c)?(0,i.jsx)("div",{ref:d,style:{position:"absolute",left:A,top:j,transform:"translateX(-1px)",width:2,height:100,backgroundColor:"rgba(255, 0, 0, 0.5)",zIndex:100,pointerEvents:"none",transition:"left 0.1s linear, top 0.2s ease"}}):null}function ei(){let e=(0,l.useRef)(null),t=(0,l.useRef)(null),{score:n,selection:s}=(0,r.QG)(),[o,a]=(0,l.useState)("notation");return((0,l.useEffect)(()=>{n&&new ee({notationContainer:e.current,tabContainer:t.current,score:n,selection:s}).render()},[n,n]),n)?(0,i.jsxs)("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,i.jsxs)("div",{style:{display:"flex",width:"100%",borderBottom:"1px solid #ccc",background:"#fafafa",flexShrink:0},children:[(0,i.jsx)("button",{onClick:()=>a("notation"),style:{flex:1,padding:"12px 0",fontSize:16,fontWeight:"notation"===o?"bold":"normal",background:"notation"===o?"#1976d2":"#eaeaea",color:"notation"===o?"#fff":"#333",border:"none",cursor:"pointer"},children:"SCORE"}),(0,i.jsx)("button",{onClick:()=>a("tab"),style:{flex:1,padding:"12px 0",fontSize:16,fontWeight:"tab"===o?"bold":"normal",background:"tab"===o?"#1976d2":"#eaeaea",color:"tab"===o?"#fff":"#333",border:"none",cursor:"pointer"},children:"TAB"})]}),(0,i.jsxs)("div",{style:{flex:1,overflowX:"auto",overflowY:"hidden",display:"flex",alignItems:"flex-start",justifyContent:"flex-start",position:"relative",width:"100%",minHeight:0},children:[(0,i.jsx)(en,{activeTab:o}),(0,i.jsxs)("div",{style:{display:"flex",minHeight:"100%"},children:[(0,i.jsx)("div",{ref:e,className:"notation",style:{display:"notation"===o?"block":"none"}}),(0,i.jsx)("div",{ref:t,className:"tablature",style:{display:"tab"===o?"block":"none"}})]})]})]}):(0,i.jsx)("div",{style:{padding:20,textAlign:"center"},children:"Loading score…"})}var el=n(41316),er=n(18952),es=n(3061),eo=n(76543),ea=n(87619),ed=n(71918),ec=n(64266);function eu(){var e,t;let{selection:n,updateScore:a,deleteNote:c,insertNoteFromStringFret:u}=(0,r.QG)(),[h,x]=(0,l.useState)(null);if((0,l.useEffect)(()=>(x(n.selected),n.subscribe(x)),[n]),!h)return(0,i.jsxs)(s.A,{sx:{width:300,p:2,borderLeft:"1px solid #ddd",bgcolor:"#fafafa"},children:[(0,i.jsx)(V.A,{variant:"h6",gutterBottom:!0,children:"Inspector"}),(0,i.jsx)(V.A,{variant:"body2",color:"textSecondary",children:"Select a note to edit properties."})]});let f=e=>{a(t=>{let n=null;e:for(let e of t.measures)for(let t of e.voices){let e=t.elements.find(e=>e.note.id===h.id);if(e){n=e.note;break e}}n&&e(n)})},m=(e,t)=>{f(n=>{n.pitch||(n.pitch=new j.A),n.pitch[e]=t})},A=h.pitch||{step:"C",alter:0,octave:4},b=h.duration||{symbol:"q"};return(0,i.jsxs)(s.A,{sx:{width:300,p:2,borderLeft:"1px solid #ddd",bgcolor:"#fafafa",overflowY:"auto",height:"100%"},children:[(0,i.jsx)(V.A,{variant:"h6",gutterBottom:!0,children:"Note Inspector"}),(0,i.jsxs)(el.Ay,{container:!0,spacing:2,children:[(0,i.jsx)(el.Ay,{item:!0,xs:12,children:(0,i.jsx)(V.A,{variant:"subtitle2",sx:{mt:1},children:"Pitch"})}),(0,i.jsx)(el.Ay,{item:!0,xs:4,children:(0,i.jsxs)(er.A,{fullWidth:!0,size:"small",children:[(0,i.jsx)(es.A,{children:"Step"}),(0,i.jsx)(eo.A,{value:A.step,label:"Step",onChange:e=>m("step",e.target.value),children:["C","D","E","F","G","A","B"].map(e=>(0,i.jsx)(d.A,{value:e,children:e},e))})]})}),(0,i.jsx)(el.Ay,{item:!0,xs:4,children:(0,i.jsxs)(er.A,{fullWidth:!0,size:"small",children:[(0,i.jsx)(es.A,{children:"Acc"}),(0,i.jsxs)(eo.A,{value:A.alter,label:"Acc",onChange:e=>m("alter",e.target.value),children:[(0,i.jsx)(d.A,{value:0,children:"Nat"}),(0,i.jsx)(d.A,{value:1,children:"#"}),(0,i.jsx)(d.A,{value:-1,children:"b"}),(0,i.jsx)(d.A,{value:2,children:"##"}),(0,i.jsx)(d.A,{value:-2,children:"bb"})]})]})}),(0,i.jsx)(el.Ay,{item:!0,xs:4,children:(0,i.jsx)(ea.A,{label:"Oct",type:"number",size:"small",value:A.octave,onChange:e=>m("octave",parseInt(e.target.value)),inputProps:{min:0,max:9}})}),(0,i.jsx)(el.Ay,{item:!0,xs:12,children:(0,i.jsx)(_.A,{})}),(0,i.jsx)(el.Ay,{item:!0,xs:12,children:(0,i.jsxs)(er.A,{fullWidth:!0,size:"small",children:[(0,i.jsx)(es.A,{children:"Duration"}),(0,i.jsxs)(eo.A,{value:b.symbol,label:"Duration",onChange:e=>{var t;return t=e.target.value,void f(e=>{e.duration=new p.A(t)})},children:[(0,i.jsx)(d.A,{value:"w",children:"Whole"}),(0,i.jsx)(d.A,{value:"h",children:"Half"}),(0,i.jsx)(d.A,{value:"q",children:"Quarter"}),(0,i.jsx)(d.A,{value:"8",children:"8th"}),(0,i.jsx)(d.A,{value:"16",children:"16th"}),(0,i.jsx)(d.A,{value:"32",children:"32nd"})]})]})}),(0,i.jsx)(el.Ay,{item:!0,xs:12,children:(0,i.jsx)(ed.A,{control:(0,i.jsx)(ec.A,{checked:h.isRest,onChange:()=>{f(e=>{e.isRest=!e.isRest})}}),label:"Rest"})}),(0,i.jsx)(el.Ay,{item:!0,xs:12,children:(0,i.jsx)(_.A,{})}),(0,i.jsx)(el.Ay,{item:!0,xs:12,children:(0,i.jsx)(V.A,{variant:"subtitle2",children:"Tablature"})}),(0,i.jsx)(el.Ay,{item:!0,xs:6,children:(0,i.jsx)(ea.A,{label:"String",type:"number",size:"small",value:null!=(e=h.string)?e:"",onChange:e=>f(t=>t.string=parseInt(e.target.value))})}),(0,i.jsx)(el.Ay,{item:!0,xs:6,children:(0,i.jsx)(ea.A,{label:"Fret",type:"number",size:"small",value:null!=(t=h.fret)?t:"",onChange:e=>f(t=>t.fret=parseInt(e.target.value))})}),(0,i.jsx)(el.Ay,{item:!0,xs:12,children:(0,i.jsx)(_.A,{})}),(0,i.jsx)(el.Ay,{item:!0,xs:12,children:(0,i.jsx)(V.A,{variant:"subtitle2",children:"Techniques"})}),(0,i.jsx)(el.Ay,{item:!0,xs:12,children:(0,i.jsxs)(er.A,{fullWidth:!0,size:"small",children:[(0,i.jsx)(es.A,{children:"Type"}),(0,i.jsxs)(eo.A,{value:h.technique||"",label:"Type",onChange:e=>f(t=>{t.technique=e.target.value||null}),children:[(0,i.jsx)(d.A,{value:"",children:"None"}),(0,i.jsx)(d.A,{value:"slide",children:"Slide"}),(0,i.jsx)(d.A,{value:"hammer",children:"Hammer-on"}),(0,i.jsx)(d.A,{value:"pull",children:"Pull-off"}),(0,i.jsx)(d.A,{value:"bend",children:"Bend"})]})]})}),"bend"===h.technique&&(0,i.jsx)(el.Ay,{item:!0,xs:12,children:(0,i.jsxs)(er.A,{fullWidth:!0,size:"small",children:[(0,i.jsx)(es.A,{children:"Bend Amount"}),(0,i.jsxs)(eo.A,{value:h.bend||"Full",label:"Bend Amount",onChange:e=>f(t=>{t.bend=e.target.value}),children:[(0,i.jsx)(d.A,{value:"Half",children:"Half (1/2)"}),(0,i.jsx)(d.A,{value:"Full",children:"Full (1)"}),(0,i.jsx)(d.A,{value:"1.5",children:"1.5"}),(0,i.jsx)(d.A,{value:"2",children:"2"})]})]})}),(0,i.jsx)(el.Ay,{item:!0,xs:12,sx:{mt:2},children:(0,i.jsx)(o.A,{variant:"contained",color:"error",fullWidth:!0,onClick:()=>{c(h),n.clear()},children:"Delete Note"})})]}),(0,i.jsx)(_.A,{sx:{my:2}}),(0,i.jsx)(V.A,{variant:"caption",sx:{color:"text.secondary",fontWeight:"bold"},children:"DEBUG DATA"}),(0,i.jsx)(s.A,{sx:{bgcolor:"#333",color:"#0f0",p:1,borderRadius:1,fontSize:"0.7rem",fontFamily:"monospace",overflowX:"auto",mt:1},children:(0,i.jsx)("pre",{children:JSON.stringify(h,null,2)})})]})}var eh=n(46584);function ex(){return(0,i.jsxs)("div",{style:{display:"flex",position:"fixed",top:211,left:0,width:"100%",height:"calc(100vh - 211px)",overflow:"hidden",zIndex:1},children:[(0,i.jsx)(Q,{}),(0,i.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",height:"100%",overflow:"hidden",minWidth:0},children:[(0,i.jsx)("div",{style:{flexShrink:0,height:"auto",maxHeight:"50%"},children:(0,i.jsx)(eh.A,{board:"compose",showFretboardControls:!1,showCircleOfFifths:!1,showFretboard:!0,showChordComposer:!1,showProgressor:!1,showSongsSelector:!1})}),(0,i.jsx)(ei,{})]}),(0,i.jsx)(eu,{})]})}function ef(){let[e,t]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{let e=e=>{e.shiftKey&&"?"===e.key&&t(!0)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),e)?(0,i.jsxs)("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.6)",color:"white",padding:40,zIndex:2e3},onClick:()=>t(!1),children:[(0,i.jsx)("h2",{children:"Keyboard Shortcuts"}),(0,i.jsx)("p",{children:"A–G → Insert notes"}),(0,i.jsx)("p",{children:"1,2,4,8 → Durations"}),(0,i.jsx)("p",{children:"Ctrl+Z / Ctrl+Y → Undo/Redo"}),(0,i.jsx)("p",{children:"Space → Play/Pause"})]}):null}function em(){return(0,i.jsxs)(r.Sm,{children:[(0,i.jsx)(I,{}),(0,i.jsx)(G,{}),(0,i.jsx)(O,{}),(0,i.jsx)(ex,{}),(0,i.jsx)(ef,{})]})}var ep=n(77328),eA=n.n(ep),ej=n(67763);let eb=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eA(),{children:[(0,i.jsx)("title",{children:"Compose And Share Music Using Guitar Sheets"}),(0,i.jsx)("meta",{name:"keywords",content:ej.z}),(0,i.jsx)("meta",{name:"description",content:"Compose And Play Guitar Songs on all keys, chorsd, shapes, scales, modes, arpeggios."})]}),(0,i.jsx)("div",{style:{marginTop:"65px"},children:(0,i.jsx)(em,{})})]})}},e=>{e.O(0,[7971,7181,8792,3434,1316,1258,5812,5926,973,7619,3405,4856,4793,6584,636,6593,6411],()=>e(e.s=29007)),_N_E=e.O()}]);