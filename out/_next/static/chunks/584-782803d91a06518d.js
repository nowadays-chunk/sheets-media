"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[584],{12700:(e,t,i)=>{i.d(t,{A:()=>r});var n=i(61302),s=i(59100);class r{serialize(){var e,t;return{id:this.id,pitch:(null==(e=this.pitch)?void 0:e.serialize())||null,duration:(null==(t=this.duration)?void 0:t.serialize())||null,isRest:this.isRest,string:this.string,fret:this.fret,technique:this.technique,bend:this.bend,midi:this.midi,velocity:this.velocity}}static deserialize(e){var t,i,a,l,o,c;let d=new r(n.A.deserialize(e.pitch),s.A.deserialize(e.duration));return e.id&&(d.id=e.id),d.isRest=e.isRest,d.string=null!=(t=e.string)?t:null,d.fret=null!=(i=e.fret)?i:null,d.technique=null!=(a=e.technique)?a:null,d.bend=null!=(l=e.bend)?l:null,d.midi=null!=(o=e.midi)?o:null,d.velocity=null!=(c=e.velocity)?c:1,d}constructor(e,t){this.pitch=e,this.duration=t,this.isRest=!1,this.string=null,this.fret=null,this.midi=null,this.velocity=1,this.id=Math.random().toString(36).substr(2,9),this.technique=null,this.bend=null}}},28044:(e,t,i)=>{i.d(t,{A:()=>l});var n=i(37610),s=i(73173),r=i(35007),a=i(49576);class l{addVoice(){let e=new n.A;return this.voices.push(e),e}serialize(){return{index:this.index,timeSignature:this.timeSignature.serialize(),keySignature:this.keySignature.serialize(),clef:this.clef.serialize(),voices:this.voices.map(e=>e.serialize())}}static deserialize(e){let t=new l(e.index,s.A.deserialize(e.timeSignature));return t.keySignature=r.A.deserialize(e.keySignature),t.clef=a.A.deserialize(e.clef),t.voices=e.voices.map(e=>n.A.deserialize(e)),t}constructor(e,t){this.index=e,this.timeSignature=t,this.keySignature=new r.A("C"),this.clef=new a.A("treble"),this.voices=[]}}},35007:(e,t,i)=>{i.d(t,{A:()=>n});class n{clone(){return new n(this.key)}serialize(){return{key:this.key}}static deserialize(e){return new n(e.key)}constructor(e="C"){this.key=e}}},37610:(e,t,i)=>{i.d(t,{A:()=>s});var n=i(12700);class s{addNote(e,t){this.elements.push({beat:e,note:t})}serialize(){return{elements:this.elements.map(e=>({beat:e.beat,note:e.note.serialize()}))}}static deserialize(e){let t=new s;for(let i of e.elements||[])t.elements.push({beat:i.beat,note:n.A.deserialize(i.note)});return t}constructor(){this.elements=[]}}},46584:(e,t,i)=>{let n;i.d(t,{A:()=>ej});var s=i(37876),r=i(14232),a=i(71733),l=i(14379),o=i(55871),c=i(9648),d=i(17203),h=i(73078),u=i(31777),g=i(37680),p=i(95386);let m=(e,t,i)=>{var n=i[e];return p.A.notes.sharps[(n+t)%12]};var x=i(89099);let f=[4,11,7,2,9,4];var v=i(95062),A=i.n(v);i(90570),i(6185);let b=(0,l.A)("div")({width:"100%",maxWidth:"100vw","@media (min-width: 1024px)":{width:"100%",height:"100%"},"@media print":{width:"100%",height:"100%"}}),S=(0,l.A)("table")({width:"100%",borderCollapse:"collapse",tableLayout:"fixed",borderSpacing:0}),y=(0,l.A)("tr")({margin:0,padding:0,height:25}),j=(0,l.A)("th")({width:25,height:25,minWidth:25,maxWidth:25,minHeight:25,maxHeight:25,padding:0,margin:0,borderTop:"none",borderRight:"none",borderLeft:"none",borderBottom:"none",textAlign:"center",verticalAlign:"middle",fontSize:10,lineHeight:"".concat(25,"px"),fontWeight:"bold",userSelect:"none"}),w=(0,l.A)("td")({width:25,height:25,minWidth:25,maxWidth:25,minHeight:25,maxHeight:25,padding:0,margin:0,borderRight:"1px solid black",verticalAlign:"middle",position:"relative",cursor:"pointer",textAlign:"center",overflow:"hidden"}),k=(0,l.A)("div")({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:20,height:20,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2,fontWeight:"bold",fontSize:11,lineHeight:1,transition:"transform 0.1s ease-in-out",userSelect:"none",border:"1px solid black"}),C=(0,l.A)("span")({fontSize:11,fontWeight:"bold",textAlign:"center",color:"#000","@media print":{fontSize:10}}),I=(0,l.A)("hr")({position:"absolute",top:"50%",left:0,right:0,width:"100%",margin:0,padding:0,border:"none",borderTop:"1px solid black",transform:"translateY(-50%)",zIndex:1,pointerEvents:"none"}),E=(0,l.A)("input")({width:25,height:25,borderRadius:"50%",border:"1px solid #ccc",textAlign:"center",outline:"none",fontSize:11,lineHeight:"".concat(25,"px"),boxSizing:"border-box",background:"#fff"}),z=e=>{let{boards:t,handleFretboardSelect:i,onElementChange:n,onNoteClick:r,selectedFretboard:a,visualizerModalIndex:l}=e,o=t.map((e,t)=>{let o=Math.min(a.generalSettings.page.includes("references")?6:e.generalSettings.nostrs,12),c=e.generalSettings.nofrets,d=Array.from({length:c},(e,t)=>t),h=[...Array(o)].map((i,o)=>(0,s.jsxs)(y,{children:[(0,s.jsx)(w,{children:(0,s.jsx)(E,{value:p.A.notes.flats[e.generalSettings.tuning[o]]||"",onChange:t=>{let i=[...e.generalSettings.tuning];""!==t.target.value&&(i[o]=p.A.notes.flats.indexOf(t.target.value),n(i.join("-"),"tuning"))}})}),d.map(i=>{var n,c,d,h,u,g;let m=(null==(d=e[e.generalSettings.choice+"Settings"])||null==(c=d.fretboard)||null==(n=c[o])?void 0:n[i])||{},x=(e.generalSettings.tuning[o]+i)%12,f=p.A.notes.sharps[x],v="",A=0;"scale"===e.generalSettings.choice&&e.scaleSettings.scale&&(null==(h=p.A.scales[e.scaleSettings.scale])?void 0:h.isModal)&&(v=null==(g=e[e.generalSettings.choice+"Settings"])||null==(u=g.notes)?void 0:u.indexOf(m.current),A=l>=0?l:e.keySettings.mode);let b=((e,t,i)=>{let n="lightblue";return e.show&&"1"===e.interval&&(n="lightsalmon"),0===t&&(n="lightsalmon"),t===i&&(n="darkseagreen"),{backgroundColor:n}})(m,v,A);return(0,s.jsxs)(w,{onClick:()=>{let e=((e,t)=>{let i=(a.generalSettings.tuning[e]+t)%12,n=p.A.notes.sharps[i],s=((e,t)=>{var i,n;let s=((null==a||null==(i=a.generalSettings)?void 0:i.baseOctaves)||[])[e],r=(null==a||null==(n=a.generalSettings)?void 0:n.tuning)||[],l=p.A.notes.sharps,o=r[e]%12;for(let e=0;e<=t;e++)"B"===l[(o+e)%12]&&s++;return s})(e,t),r=a.generalSettings.tuning[e]+t+12*s;return{type:"note",raw:n+s,pitch:{name:n,step:n[0],accidental:n.includes("#")?"#":"",octave:s,midi:r},guitar:{string:e,fret:t,tuningIndex:a.generalSettings.tuning[e]},velocity:.9,duration:1}})(o,i);console.log("DAW event → ",e),r(e)},children:[(0,s.jsx)(I,{}),m.show&&(0,s.jsx)(k,{id:"note-".concat(t,"-").concat(o,"-").concat(i),style:b,children:(0,s.jsx)(C,{children:f})})]},"note-".concat(t,"-").concat(o,"-").concat(i))})]},"row-".concat(t,"-").concat(o))),u=[(0,s.jsx)(j,{children:"tuner"},"tuner"),d.map((e,i)=>(0,s.jsx)(j,{children:e},"head-".concat(t,"-").concat(i)))];return(0,s.jsxs)(b,{onFocus:()=>i(t),onClick:()=>i(t),children:[(0,s.jsxs)("label",{style:{fontWeight:"bold"},children:["#Strings:",(0,s.jsx)("input",{type:"number",style:{margin:"6px"},value:o,onChange:e=>n(e.target.value,"nostrs"),min:"4",max:"12"},"strings-changer")]}),(0,s.jsxs)("label",{style:{fontWeight:"bold"},children:["#Frets:",(0,s.jsx)("input",{type:"number",style:{margin:"6px"},value:c,onChange:e=>n(e.target.value,"nofrets"),min:"12",max:"24"},"frets-changer")]}),(0,s.jsxs)(S,{children:[(0,s.jsx)("tbody",{children:h}),(0,s.jsx)("tfoot",{children:(0,s.jsx)(y,{children:u})})]})]},"fretboard-".concat(t))});return(0,s.jsx)("div",{children:o})};z.propTypes={boards:A().array,handleFretboardSelect:A().func.isRequired,onElementChange:A().func.isRequired,onNoteClick:A().func,selectedFretboard:A().object.isRequired};var N=i(65754),O=i(35003),F=i(55751),M=i(41316),R=i(35268),B=i(41681),q=i(48230),P=i.n(q);let T=(0,R.Ay)(N.A)(e=>{let{selected:t}=e;return{borderRadius:"20px",margin:"4px",background:t?"#1976d2":"transparent",color:t?"#fff":"#1976d2",border:"1px solid #1976d2","&:hover":{background:t?"#11529b":"rgba(25,118,210,0.1)"},textTransform:"none"}}),W=e=>{let{children:t}=e;return(0,s.jsx)(O.A,{variant:"h6",sx:{mt:2,mb:1},children:t})},D=e=>(e||"").replace("#","sharp"),_=e=>{var t;let{choice:i,handleChoiceChange:n,selectedKey:r,onElementChange:a,scaleModes:l,arppegiosNames:o,onCleanFretboard:c,selectedMode:d,selectedScale:h,selectedChord:u,selectedArppegio:g,selectedShape:m,saveProgression:x,playSelectedNotes:f,progression:v,createNewBoardDisplay:A}=e,b=p.A.notes.sharps,S=(()=>{let e=b[r];if(!e)return null;let t=D(e);if("chord"===i)return u?"/spreading/chords/".concat(t,"/").concat(D(u)):null;if("arppegio"===i)return g?"/spreading/arppegios/".concat(t,"/").concat(D(g)):null;if("scale"===i){if(!h)return null;let e=p.A.scales[h];if(null==e?void 0:e.isModal){var n;if(""===d||null==d)return null;let e=null==(n=l[Number(d)])?void 0:n.name;if(!e)return null;let i=e.toLowerCase().replace(/\s+/g,"-");return"/spreading/scales/".concat(t,"/").concat(h,"/modal/").concat(i)}return"/spreading/scales/".concat(t,"/").concat(h,"/single")}return null})(),y=!!S;return(0,s.jsxs)("footer",{style:{marginTop:"20px",position:"relative"},children:[(0,s.jsx)(N.A,{onClick:()=>{c(),a(-1,"key"),a(-1,"scale"),a(-1,"mode"),a("","chord"),a(-1,"arppegio"),a("","shape")},sx:{position:"absolute",right:0,top:-10,minWidth:"30px",padding:"4px",borderRadius:"50%",color:"#1976d2"},children:(0,s.jsx)(B.A,{})}),(0,s.jsx)(W,{children:"Category"}),(0,s.jsxs)(F.A,{children:[(0,s.jsx)(T,{selected:"scale"===i,onClick:()=>n("scale"),children:"Scales"}),(0,s.jsx)(T,{selected:"chord"===i,onClick:()=>n("chord"),children:"Chords"}),(0,s.jsx)(T,{selected:"arppegio"===i,onClick:()=>n("arppegio"),children:"Arpeggios"})]}),i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W,{children:"Key"}),(0,s.jsx)(F.A,{children:b.map((e,t)=>(0,s.jsx)(T,{selected:r===t,onClick:()=>a(t,"key"),children:e},t))})]}),"scale"===i&&""!==r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W,{children:"Scale Type"}),(0,s.jsx)(F.A,{children:Object.keys(p.A.scales).map((e,t)=>(0,s.jsx)(T,{selected:h===e,onClick:()=>a(e,"scale"),children:(e=>e.charAt(0).toUpperCase()+e.slice(1))(e)},t))})]}),"chord"===i&&""!==r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W,{children:"Chord Type"}),(0,s.jsx)(F.A,{children:Object.keys(p.A.arppegios).map((e,t)=>(0,s.jsx)(T,{selected:u===e,onClick:()=>a(e,"chord"),children:e},t))})]}),"arppegio"===i&&""!==r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W,{children:"Arpeggio Type"}),(0,s.jsx)(F.A,{children:o.map((e,t)=>(0,s.jsx)(T,{selected:g===e,onClick:()=>a(e,"arppegio"),children:e},t))})]}),"scale"===i&&h&&(null==(t=p.A.scales[h])?void 0:t.isModal)&&l.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W,{children:"Modes"}),(0,s.jsx)(F.A,{children:l.map((e,t)=>(0,s.jsx)(T,{selected:Number(d)===t,onClick:()=>a(t,"mode"),children:e.name},t))})]}),(0,s.jsx)(W,{children:"Shape"}),(0,s.jsx)(F.A,{children:p.A.shapes.names.map((e,t)=>(0,s.jsx)(T,{selected:m===e,onClick:()=>a(e,"shape"),children:e},t))}),(0,s.jsxs)(M.Ay,{container:!0,spacing:2,sx:{mt:2},children:[(0,s.jsx)(M.Ay,{item:!0,xs:6,children:(0,s.jsx)(N.A,{fullWidth:!0,variant:"contained",color:"primary",onClick:c,children:"Clean"})}),(0,s.jsx)(M.Ay,{item:!0,xs:6,children:(0,s.jsx)(N.A,{fullWidth:!0,variant:"contained",color:"secondary",onClick:A,children:"Create Fretboard"})}),(0,s.jsx)(M.Ay,{item:!0,xs:6,children:(0,s.jsx)(N.A,{fullWidth:!0,variant:"contained",color:"primary",onClick:f,children:"Play Sound"})}),(0,s.jsx)(M.Ay,{item:!0,xs:6,children:y?(0,s.jsx)(P(),{href:S,target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none"},children:(0,s.jsx)(N.A,{fullWidth:!0,variant:"contained",color:"success",children:"Read Spreadings"})}):(0,s.jsx)(N.A,{fullWidth:!0,variant:"contained",color:"success",disabled:!0,children:"Read Spreadings"})})]})]})};_.propTypes={handleChoiceChange:A().func.isRequired,selectedKey:A().any,scaleModes:A().array.isRequired,arppegiosNames:A().array.isRequired,choice:A().string.isRequired,onCleanFretboard:A().func.isRequired,selectedMode:A().any,selectedScale:A().string,selectedChord:A().string,selectedShape:A().string,selectedArppegio:A().string,saveProgression:A().func.isRequired,progression:A().array,onElementChange:A().func.isRequired,playSelectedNotes:A().func.isRequired};let V=e=>{let{tone:t,quality:i,onElementChange:n}=e,[a,l]=(0,r.useState)(null),[o,c]=(0,r.useState)(null);(0,r.useEffect)(()=>{l(t),c(i)},[t,i]);let d=p.A.circleOfFifths.map(e=>e.key),h=p.A.circleOfFifths.map(e=>e.relative),u=(e,t)=>{let i=(e-90)*Math.PI/180;return{x:t*Math.cos(i),y:t*Math.sin(i)}},g=(e,t)=>{l(e),c(t)},m=0,x=a,f=a;if("Major"===o||"Dominant"===o){let e=d.indexOf(a);-1!==e&&(m=-30*e,f=p.A.circleOfFifths[e].relative)}else if("Minor"===o){let e=h.indexOf(a+"m");if(-1!==e){var v;m=-30*e,x=null==(v=p.A.circleOfFifths.find(e=>e.relative===a))?void 0:v.key}}let A=(e,t)=>{let i=d.indexOf(x),n=h.indexOf(f+"m");if(t){if(-1===i)return!1;let t=[];for(let e=-1;e<=5;e++)t.push((i+e+d.length)%d.length);return t.includes(e)}if(!t){if(-1===n)return!1;let t=[];for(let e=-1;e<=5;e++)t.push((n+e+h.length)%h.length);return t.includes(e)}return!1};return(0,s.jsx)("div",{className:"circle-container",children:(0,s.jsx)("svg",{viewBox:"-200 -200 400 400",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsxs)("g",{className:"circleOfFifthsTransition",transform:"rotate(".concat(m,", 0, 0)"),children:[(0,s.jsx)("circle",{cx:"0",cy:"0",r:150,fill:"none",stroke:"black"}),(0,s.jsx)("circle",{cx:"0",cy:"0",r:110,fill:"none",stroke:"black"}),d.map((e,t)=>{let i=u(30*t,150),n=-m,r=A(t,!0);return(0,s.jsxs)("g",{transform:"translate(".concat(i.x,", ").concat(i.y,")"),className:"hover-group",onClick:()=>g(e,"Major"),children:[(0,s.jsx)("circle",{cx:"0",cy:"0",r:"20",fill:r?"#D04848":"white",stroke:"black",className:"circle-hover"}),(0,s.jsx)("text",{x:"0",y:"0",fontSize:"12",textAnchor:"middle",alignmentBaseline:"middle",transform:"rotate(".concat(n,")"),children:e})]},e)}),h.map((e,t)=>{let i=u(30*t,110),n=-m,r=A(t,!1);return(0,s.jsxs)("g",{transform:"translate(".concat(i.x,", ").concat(i.y,")"),className:"hover-group",onClick:()=>g(e.replace("m",""),"Minor"),children:[(0,s.jsx)("circle",{cx:"0",cy:"0",r:"15",fill:r?"#1E90FF":"white",stroke:"black",className:"circle-hover"}),(0,s.jsx)("text",{x:"0",y:"0",fontSize:"10",textAnchor:"middle",alignmentBaseline:"middle",transform:"rotate(".concat(n,")"),fill:"black",children:e})]},"minor-".concat(e,"-").concat(t))})]})})})};var L=i(18952),J=i(60595),H=i(76543),G=i(78753),K=i(3061);let{DataSet:X}=i(24287),{Network:U}=i(27167),Y=e=>{let{nodesData:t,edgesData:i,onNodeClick:n}=e,a=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=new X(t),s=new X(i),r=new U(a.current,{nodes:e,edges:s},{interaction:{hover:!0},nodes:{shape:"dot",size:20},edges:{width:2,smooth:!0}});return r.on("click",e=>{e.nodes.length>0&&n(e.nodes[0])}),()=>{r.destroy()}},[t,i,n]),(0,s.jsx)("div",{ref:a,style:{height:"400px",width:"100%"}})};function Q(e){return e===e.toLowerCase()}let Z=(0,l.A)("div")({display:"flex",flexDirection:"column",alignItems:"center"}),$=e=>{let{children:t}=e;return(0,s.jsx)(O.A,{variant:"h6",sx:{mt:2,mb:1},children:t})},ee=(0,l.A)(N.A)(e=>{let{selected:t}=e;return{borderRadius:"20px",margin:"4px",background:t?"#1976d2":"transparent",color:t?"#fff":"#1976d2",border:"1px solid #1976d2","&:hover":{background:t?"#11529b":"rgba(25,118,210,0.1)"},textTransform:"none"}}),et=(0,l.A)(L.A)({width:"100%"}),ei=(0,l.A)("div")({height:400,width:"100%",border:"1px solid rgba(0, 0, 0, 0.3)"}),en=(0,l.A)("div")({marginTop:"1rem",padding:"0.5rem",border:"1px solid rgba(0, 0, 0, 0.3)",overflowX:"auto",display:"flex",alignItems:"center"}),es=["I","ii","iii","IV","V","vi","vii\xb0","i","ii\xb0","III","iv","v","VI","VII"],er=e=>{let{addChordToProgression:t,saveProgression:i,playProgression:n,selectedArppegio:a,onElementChange:l,selectedKey:o}=e,[c,d]=(0,r.useState)([]),[h,u]=(0,r.useState)([]),[g,m]=(0,r.useState)([]),[x,f]=(0,r.useState)([]),[v,A]=(0,r.useState)(!0),[b,S]=(0,r.useState)([]),y=(e,t)=>{let i="";switch(e){case"I":i="".concat(p.A.notes.sharps[p.A.notes.sharps.indexOf(t)%12]," Major");break;case"ii":case"iv":i="".concat(p.A.notes.sharps[(p.A.notes.sharps.indexOf(t)+2)%12]," minor");break;case"iii":case"v":i="".concat(p.A.notes.sharps[(p.A.notes.sharps.indexOf(t)+4)%12]," minor");break;case"IV":case"VI":i="".concat(p.A.notes.sharps[(p.A.notes.sharps.indexOf(t)+5)%12]," Major");break;case"V":case"VII":i="".concat(p.A.notes.sharps[(p.A.notes.sharps.indexOf(t)+7)%12]," Major");break;case"vi":case"i":i="".concat(p.A.notes.sharps[(p.A.notes.sharps.indexOf(t)+9)%12]," minor");break;case"vii\xb0":case"ii\xb0":i="".concat(p.A.notes.sharps[(p.A.notes.sharps.indexOf(t)+11)%12]," diminished");break;case"III":i="".concat(p.A.notes.sharps[(p.A.notes.sharps.indexOf(t)+12)%12]," Major")}return i},j=es.map((e,t)=>({id:"".concat(e,"-").concat(t),label:"".concat(e," - ").concat(y(e,p.A.notes.sharps[o||0])),group:"roman",x:400*Math.random(),y:400*Math.random()})),w=[],k=[];for(let e in p.A.arppegios){let t=p.A.arppegios[e];"Major"===t.degree?w.push(t.name):"Minor"===t.degree&&k.push(t.name)}return(0,r.useEffect)(()=>{S(es.map(e=>"".concat(e," - ").concat(y(e,p.A.notes.sharps[o]))))},[o]),(0,s.jsxs)(Z,{children:[(0,s.jsxs)(M.Ay,{container:!0,spacing:2,children:[(0,s.jsxs)(M.Ay,{item:!0,xs:12,children:[(0,s.jsx)(O.A,{variant:"h6",children:"Please, chose a key to begin"}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)($,{children:"Key"}),(0,s.jsx)(F.A,{children:p.A.notes.sharps.map((e,t)=>(0,s.jsx)(ee,{selected:o===t,onClick:()=>l(t,"key"),children:e},t))})]})]}),(0,s.jsx)(M.Ay,{item:!0,xs:12,children:(0,s.jsxs)(en,{children:[0===c.length&&(0,s.jsx)(O.A,{variant:"h6",children:"Selected Chord Progression Should Appear Here..."}),c.length>0&&c.map((e,t)=>(0,s.jsxs)(r.Fragment,{children:[(0,s.jsxs)(J.A,{style:{height:"48px",backgroundColor:"beige",display:"flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",border:"1px solid rgba(0, 0, 0, 0.3)",boxShadow:"2px 2px 4px rgba(0, 0, 0, 0.1)"},children:[(0,s.jsx)(O.A,{variant:"h6",sx:{m:4},children:e.label}),(0,s.jsxs)(H.A,{labelId:"arppegio-name-label",id:"arppegio-name-select",fullWidth:!0,value:a,onChange:e=>l(e.target.value,"choice"),displayEmpty:!0,children:[Q(e.label[0])&&k.map((e,t)=>(0,s.jsx)(G.A,{value:e,children:e},t)),!Q(e.label[0])&&w.map((e,t)=>(0,s.jsx)(G.A,{value:e,children:e},t))]})]}),t<c.length-1&&(0,s.jsx)("span",{style:{margin:"0 0.5rem",fontSize:"1.5rem"},children:"→"})]},t))]})}),(0,s.jsx)(M.Ay,{item:!0,xs:12,children:(0,s.jsxs)(et,{children:[(0,s.jsx)(K.A,{id:"select-roman-label",children:"Selected Roman Numeral"}),(0,s.jsx)(H.A,{labelId:"select-roman-label",value:b[0]||"",onChange:e=>{u(e.target.value)},sx:{border:"none"},children:b.length>0&&b.map((e,t)=>(0,s.jsx)(G.A,{value:e,children:e},t))})]})})]}),(0,s.jsx)(ei,{children:(0,s.jsx)(Y,{nodesData:v?j:g,edgesData:x,onNodeClick:e=>{let t=e.split("-")[0],i=b.filter(e=>e!==t).map((e,t)=>({id:"".concat(e,"-").concat(g.length+t,"-").concat(c.join("-")),label:"".concat(e," - ").concat(y(e,p.A.notes.sharps[o||0])),group:"roman",x:400*Math.random(),y:400*Math.random()})),n=i.map(t=>({id:"edge-".concat(e,"-").concat(t.id),from:e,to:t.id}));m([...g.filter(e=>"roman"!==e.group),{id:e,label:"".concat(t," - ").concat(y(t,p.A.notes.sharps[o||0])),group:"chosen"},...i]),f([...x,...n]),d([...c,{id:e,label:"".concat(t," - ").concat(y(t,p.A.notes.sharps[o||0]))}]),A(!1)}})}),(0,s.jsxs)(M.Ay,{container:!0,spacing:2,style:{marginTop:"1rem"},children:[(0,s.jsx)(M.Ay,{item:!0,xs:12,style:{textAlign:"center"},children:(0,s.jsx)(N.A,{variant:"outlined",size:"large",onClick:()=>i(h),children:"Save Progression"})}),(0,s.jsx)(M.Ay,{item:!0,xs:12,style:{textAlign:"center"},children:(0,s.jsx)(N.A,{variant:"outlined",size:"large",onClick:()=>n(h),children:"Play Progression"})})]})]})};er.propTypes={addChordToProgression:A().func.isRequired,saveProgression:A().func.isRequired,playProgression:A().func.isRequired,selectedArppegio:A().string,onElementChange:A().func.isRequired,selectedKey:A().number.isRequired};var ea=i(87174),el=i(55471),eo=i(58271);let ec=(0,l.A)("div")({display:"flex",flexDirection:"column",maxWidth:"100vw",overflowX:"hidden",overflowY:"hidden",position:"relative"}),ed=(0,l.A)("div")(e=>{let{drawerOpen:t}=e;return{position:"relative",flex:1,width:"100%",overflowY:"auto",overflowX:"hidden",margin:0,padding:0,transition:"margin-left 0.3s ease",...t&&{"@media (min-width:1200px)":{marginLeft:-600}}}}),eh=(0,l.A)("div")({width:"100%",maxWidth:"100vw",overflowX:"hidden",margin:0,"@media (max-width:1200px)":{padding:"0px 15px"},"@media (min-width:1200px)":{padding:"0px 180px"},boxSizing:"border-box"}),eu=(0,l.A)("div")(e=>{let{open:t}=e;return{position:"fixed",top:44,right:0,height:"calc(100vh - ".concat(44,"px)"),width:t?600:40,minWidth:t?600:40,backgroundColor:"#f5f5f5",borderLeft:"1px solid #ddd",zIndex:2e3,transition:"width 0.3s ease",display:"flex",flexDirection:"column","@media (max-width:1200px)":{display:"none"}}}),eg=(0,l.A)("div")(e=>{let{open:t}=e;return{height:t?25:45,borderBottom:"1px solid #ddd",display:"flex",padding:10*!!t,alignItems:t?"flex-start":"center",justifyContent:t?"flex-start":"center"}}),ep=(0,l.A)(a.A)({width:24,height:24,border:"2px solid #463f4b",borderRadius:"50%",background:"#fff",padding:6,"&:hover":{background:"#f0f0f0"}}),em=(0,l.A)("div")(e=>{let{open:t}=e;return{flex:1,width:"100%",padding:24*!!t,opacity:+!!t,pointerEvents:t?"auto":"none",transition:"opacity 0.2s ease",overflowY:"auto"}}),ex=(0,l.A)("div")(e=>{let{open:t}=e;return{position:"fixed",top:44,left:0,right:0,width:"100%",maxWidth:"100%",margin:0,padding:0,transform:"translateZ(0)",WebkitTransform:"translateZ(0)",WebkitOverflowScrolling:"touch",backgroundColor:"#f5f5f5",borderBottom:"1px solid #5a5656ff",zIndex:3e3,overflowX:"hidden",overflowY:t?"auto":"hidden",maxHeight:t?"100%":40,transition:"max-height 0.35s ease","@media (min-width:1200px)":{display:"none"}}}),ef=(0,l.A)("div")({height:40,display:"flex",justifyContent:"flex-end",alignItems:"center",borderBottom:"1px solid #ccc",paddingRight:20}),ev=(0,l.A)(a.A)({width:24,height:24,borderRadius:"50%",border:"2px solid #463f4b",background:"#fff"}),eA=(0,l.A)("div")({width:"100%",maxWidth:"100%",padding:"0px 40px 50px 30px",boxSizing:"border-box",overflowX:"hidden"}),eb=(0,l.A)("div")({width:"100%",maxWidth:"100%",overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch","& > *":{maxWidth:"none !important"}}),eS=(0,l.A)("div")({width:"100%",maxWidth:"100%",marginBottom:20}),ey=(0,l.A)("div")({width:"100%",display:"flex",flexDirection:"column",overflowX:"hidden"}),ej=(0,u.Ng)((e,t)=>({boards:e.fretboard.components.filter(e=>e.generalSettings.page===t.board),progressions:e.partitions}),{addFretboard:g.xd,updateBoards:g._m,setProgression:g.IY,setProgressionKey:g.xs})((n=e=>{let t=(0,u.wA)(),[i,n]=(0,r.useState)(!1),[a,l]=(0,r.useState)(!1),{board:g,boards:m,selectedFretboard:x,selectedFretboardIndex:f,handleFretboardSelect:v,handleChoiceChange:A,createNewBoardDisplay:b,cleanFretboard:S,onElementChange:y,keyIndex:j,scale:w,modeIndex:k,shape:C,quality:I,display:E,updateBoards:N,showFretboardControls:O,showFretboard:F,showChordComposer:M,showCircleOfFifths:R,showStats:B,leftDrawerOpen:q,leftDrawerWidth:P}=e,{addNoteFromFretboard:T}=(0,el.QG)(),W=(0,r.useCallback)(()=>{if(null==x?void 0:x.id){if(isNaN(j)||t(N(x.id,"keySettings."+E,j)),isNaN(k)||t(N(x.id,"keySettings.mode",k)),"scale"===E){var e;t(N(x.id,"generalSettings.choice","scale")),t(N(x.id,"scaleSettings.scale",w)),(null==(e=p.A.scales[w])?void 0:e.isModal)?(t(N(x.id,"modeSettings.mode",p.A.scales[w].modes[k].name)),""!==C&&(t(N(x.id,"modeSettings.shape",C)),t(N(x.id,"scaleSettings.shape",C)))):t(N(x.id,"scaleSettings.shape",C))}"arppegio"===E&&(t(N(x.id,"generalSettings.choice","arppegio")),t(N(x.id,"arppegioSettings.arppegio",I)),""!==C&&t(N(x.id,"arppegioSettings.shape",C))),"chord"===E&&(t(N(x.id,"generalSettings.choice","chord")),t(N(x.id,"chordSettings.chord",I)),""!==C&&t(N(x.id,"chordSettings.shape",C)))}},[t,E,x,j,k,w,C,I,N]);return((0,r.useEffect)(()=>{W()},[W]),x)?(0,s.jsxs)(ec,{children:[O&&(0,s.jsxs)(ex,{open:a,sx:{left:q?P:0,width:q?"calc(100% - ".concat(P,"px)"):"100%"},children:[(0,s.jsx)(ef,{children:(0,s.jsx)(ev,{onClick:()=>l(e=>!e),children:a?(0,s.jsx)(h.A,{}):(0,s.jsx)(d.A,{})})}),(0,s.jsx)(eA,{children:(0,s.jsx)(_,{createNewBoardDisplay:b,handleChoiceChange:A,onCleanFretboard:S,selectedKey:x.keySettings[x.generalSettings.choice],selectedScale:x.scaleSettings.scale,selectedChord:x.chordSettings.chord,selectedShape:x[x.generalSettings.choice+"Settings"].shape,selectedMode:x.modeSettings.mode,onElementChange:y,scaleModes:x.scaleSettings.scale?p.A.scales[x.scaleSettings.scale].modes:[],arppegiosNames:Object.keys(p.A.arppegios),choice:x.generalSettings.choice})})]}),(0,s.jsx)(ed,{drawerOpen:i,children:(0,s.jsx)(eh,{sx:{"@media (min-width:1200px)":{padding:"compose"===g?"20px":"0px 180px"}},children:(0,s.jsxs)(ey,{children:[(0,s.jsx)(eo.A,{}),F&&(0,s.jsx)(eS,{children:(0,s.jsx)(eb,{children:(0,s.jsx)(z,{selectedFretboard:x,boards:m,handleFretboardSelect:e=>{v(e)},onElementChange:y,onNoteClick:e=>{"compose"===x.generalSettings.page&&(console.log(e),T(e))},visualizerModalIndex:x.modeSettings.mode})})}),R&&(0,s.jsx)(V,{tone:"C",onElementChange:y,selectedFretboardIndex:f}),M&&(0,s.jsx)(er,{onElementChange:y,selectedKey:x.keySettings.key,selectedArppegio:x.arppegioSettings.arppegio}),B&&(0,s.jsx)(ea.A,{boards:m})]})})}),O&&(0,s.jsxs)(eu,{open:i,children:[(0,s.jsx)(eg,{open:i,children:(0,s.jsx)(ep,{onClick:()=>n(e=>!e),children:i?(0,s.jsx)(c.A,{}):(0,s.jsx)(o.A,{})})}),(0,s.jsx)(em,{open:i,children:(0,s.jsx)(_,{createNewBoardDisplay:b,handleChoiceChange:A,onCleanFretboard:S,selectedKey:x.keySettings[x.generalSettings.choice],selectedScale:x.scaleSettings.scale,selectedChord:x.chordSettings.chord,selectedShape:x[x.generalSettings.choice+"Settings"].shape,selectedMode:x.modeSettings.mode,onElementChange:y,scaleModes:x.scaleSettings.scale?p.A.scales[x.scaleSettings.scale].modes:[],arppegiosNames:Object.keys(p.A.arppegios),choice:x.generalSettings.choice})})]})]}):(0,s.jsx)("div",{children:"Loading..."})},e=>{let t=(0,u.wA)(),{boards:i}=e;(0,x.useRouter)();let[a,l]=(0,r.useState)(0),[o,c]=(0,r.useState)(i[a]);(0,r.useEffect)(()=>{c(i[a])},[i,a]),(0,r.useEffect)(()=>{let e=JSON.parse(localStorage.getItem("progression"));(null==e?void 0:e.length)&&t((0,g.IY)(e))},[t]),(0,r.useEffect)(()=>{var e;if(-1===a||!o)return;let{chordSettings:i,keySettings:n,scaleSettings:s,generalSettings:r,modeSettings:l,arppegioSettings:c}=o,u=r.choice;if(isNaN(n[u]))return;let x=[],f=[],y=o[u+"Settings"].shape,j=[];if("chord"===u&&i.chord&&y)return void d({key:n[u],chord:i.chord,shape:y});"arppegio"===u&&c.arppegio?(x=h(c.arppegio),f=v(c.arppegio)):"scale"===u&&s.scale&&(x=b(s.scale,n.scale),f=S(s.scale),p.A.scales[s.scale].isModal&&(j=A(x,l.mode)));let w=JSON.parse(JSON.stringify(o)),k="".concat(u,"Settings"),C=(null==(e=w[k])?void 0:e.fretboard)||[],I=w.generalSettings.nofrets||12;if(C.forEach(e=>{e.forEach(e=>{e.show=!1,e.interval=void 0})}),""!==y&&x.length&&f.length){let e=p.A.shapes.names.indexOf(y),t=n[u];r.page;let i=null;"arppegio"===u?i=p.A.shapes.indexes[c.arppegio][e]:"scale"===u&&(i=p.A.scales[s.scale].indexes[e]),C.forEach((e,n)=>{for(let e=t;e<I;e++){let s=m(n,e,w.generalSettings.tuning);if(!x.includes(s))continue;console.log("shapeIntervals.start + rootNoteIndex",[i.start,t]),console.log("shapeIntervals.end + rootNoteIndex",[i.end,t]);let a=i.start+t,l=i.end+t,o=C[n],c=null==o?void 0:o[e];if(e>=a&&e<=l){if(!c)continue;c.show=!0,c.current=r.notesDisplay?s:f[x.indexOf(s)],c.interval=f[x.indexOf(s)]}}})}else C.forEach((e,t)=>{for(let e=0;e<I;e++){let i=m(t,e,w.generalSettings.tuning);if(!x.includes(i))continue;let n=C[t],s=null==n?void 0:n[e];s&&(s.show=!0,s.current=r.notesDisplay?i:f[x.indexOf(i)],s.interval=f[x.indexOf(i)])}});w[k].modalNotes=j,w[k].notes=x,JSON.stringify(o[k])!==JSON.stringify(w[k])&&t((0,g._m)(o.id,"".concat(k),w[k]))},[o,a,t]);let d=e=>{var i;let{key:n,chord:s,shape:r}=e,a=null==(i=p.A.arppegios[s])?void 0:i.cagedShapes[r];if(!a)return;let l=a.map(e=>null===e?null:e+n);l=l.reverse();let{formula:c}=p.A.arppegios[s],d=n,h=[p.A.notes.sharps[d]];c.forEach(e=>{d=(d+e)%12,h.push(p.A.notes.sharps[d])}),h.pop();let u=p.A.arppegios[s].intervals,m=JSON.parse(JSON.stringify(o)).chordSettings.fretboard;m.forEach(e=>e.forEach(e=>{e.show=!1,e.interval=null})),m.forEach((e,t)=>{e.forEach((e,i)=>{let n=l[t];if(null===n||i!==n)return;let s=o.generalSettings.tuning[t],r=p.A.notes.sharps[(s+i)%12];h.includes(r)&&(m[t][i].show=!0,m[t][i].interval=u[h.indexOf(r)])})}),JSON.stringify(o.chordSettings.fretboard)!==JSON.stringify(m)&&t((0,g._m)(o.id,"chordSettings.fretboard",m))},h=e=>{var t;let i=null==(t=p.A.arppegios[e])?void 0:t.formula,n=parseInt(o.keySettings.arppegio);if(!i||isNaN(n))return[];let s=n,r=[p.A.notes.sharps[s]];return i.forEach(e=>{s=(s+e)%12,r.push(p.A.notes.sharps[s])}),r},v=e=>{var t;return(null==(t=p.A.arppegios[e])?void 0:t.intervals)||[]},A=(e,t)=>e.slice(parseInt(t)).concat(e.slice(0,parseInt(t))),b=(e,t)=>{if(""===e||isNaN(t))return[];let{formula:i}=p.A.scales[e],n=parseInt(t),s=[p.A.notes.sharps[n]];return i.forEach(e=>{n=(n+e)%12,s.push(p.A.notes.sharps[n])}),s.filter(e=>void 0!==e)},S=e=>{var t;return(null==(t=p.A.scales[e])?void 0:t.intervals)||[]};return(0,s.jsx)(n,{...e,selectedFretboard:o,handleFretboardSelect:e=>{l(e)},handleChoiceChange:e=>{t((0,g._m)(o.id,"generalSettings.choice",e))},createNewBoardDisplay:()=>{let e=(0,g.gX)(6,25,[4,7,2,9,11,4],[4,3,3,3,2,2],"home","scale");t((0,g.xd)(e))},cleanFretboard:()=>{if(-1===a)return;let e=o.generalSettings.choice,i=(0,g.BP)(o.generalSettings.nostrs,o.generalSettings.nofrets,o.generalSettings.tuning);t((0,g._m)(o.id,"keySettings.".concat(e),"")),t((0,g._m)(o.id,"".concat(e,"Settings.").concat(e),"")),"chord"===e&&t((0,g._m)(o.id,"".concat(e,"Settings.shape"),"")),t((0,g._m)(o.id,"".concat(e,"Settings.").concat(e),"")),t((0,g._m)(o.id,"".concat(o.generalSettings.choice,"Settings.fretboard"),i))},onElementChange:(e,i)=>{let n="notesDisplay"===i?!o.generalSettings.notesDisplay:e;(e=>{e&&e.length>0&&e.forEach(e=>{t((0,g._m)(o.id,e.property,e.value))})})(((e,t,i)=>{switch(e){case"key":return[{property:"keySettings.".concat(o.generalSettings.choice),value:t}];case"scale":return[{property:"scaleSettings.scale",value:p.A.scales[t]?t:""}];case"mode":return[{property:"modeSettings.mode",value:t>=0&&t<=6?t:""}];case"arppegio":return[{property:"arppegioSettings.arppegio",value:p.A.arppegios[t]?t:""}];case"chord":return[{property:"chordSettings.chord",value:p.A.arppegios[t]?t:""}];case"shape":return[{property:"".concat(o.generalSettings.choice,"Settings.shape"),value:t||""}];case"fret":return[{property:"chordSettings.fret",value:t>0&&t<25?t:""}];case"notesDisplay":return[{property:"generalSettings.notesDisplay",value:i}];case"tuning":return[{property:"generalSettings.tuning",value:t.split("-").map(e=>parseInt(e,10))||f}];case"nostrs":{let e=(0,g.BP)(parseInt(t),o.generalSettings.nofrets,o.generalSettings.tuning),i=o.generalSettings.baseOctaves;return 6===parseInt(t)?i=[...o.generalSettings.baseOctaves,2]:7===parseInt(t)&&(i=[...o.generalSettings.baseOctaves,1]),[{property:"generalSettings.baseOctaves",value:i},{property:"generalSettings.nostrs",value:parseInt(t)||6},{property:"scaleSettings.fretboard",value:e},{property:"chordSettings.fretboard",value:e},{property:"modeSettings.fretboard",value:e},{property:"arppegioSettings.fretboard",value:e}]}case"nofrets":{let e=(0,g.BP)(o.generalSettings.nostrs,parseInt(t),o.generalSettings.tuning);return[{property:"generalSettings.nofrets",value:parseInt(t)||12},{property:"scaleSettings.fretboard",value:e},{property:"chordSettings.fretboard",value:e},{property:"modeSettings.fretboard",value:e},{property:"arppegioSettings.fretboard",value:e}]}case"arppegio":return[{property:"arppegioSettings.arppegio",value:t},{property:"arppegioSettings.fretboard",value:(0,g.BP)(o.generalSettings.nostrs,parseInt(t),o.generalSettings.tuning)}];default:return null}})(i,e,n))},selectedFretboardIndex:a,setSelectedFretboardIndex:l,getScaleNotes:b,boards:i})}))},49576:(e,t,i)=>{i.d(t,{A:()=>n});class n{serialize(){return{name:this.name}}static deserialize(e){return new n(e.name)}clone(){return new n(this.name)}constructor(e="treble"){this.name=e}}},50684:(e,t,i)=>{i.r(t),i.d(t,{getMidiFromStringFret:()=>a,getPitchFromStringFret:()=>r});var n=i(95386),s=i(61302);function r(e,t){let i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.A.tuning,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e<1||e>6)throw Error("String must be between 1 and 6");if(t<0)throw Error("Fret must be non-negative");let l=6-e,o=r[l],c=(o+t)%12,d=[2,2,3,3,3,4][l]+Math.floor((o+t)/12),h=(i=-1===a?n.A.notes.flats[c]:n.A.notes.sharps[c])[0],u=0;return i.length>1&&("#"===i[1]?u=1:"b"===i[1]&&(u=-1)),new s.A(h,u,d)}function a(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.A.tuning,s=6-e;return([2,2,3,3,3,4][s]+1)*12+i[s]+t}},55471:(e,t,i)=>{i.d(t,{Sm:()=>j,QG:()=>w});var n=i(37876),s=i(14232),r=i(56062),a=i(12700),l=i(59100),o=i(61302);class c{snapshot(e){e&&"function"==typeof e.serialize&&(this.stack=this.stack.slice(0,this.pointer+1),this.stack.push(JSON.stringify(e.serialize())),this.pointer++)}undo(e){return this.pointer<=0?e:(this.pointer--,JSON.parse(this.stack[this.pointer]))}redo(e){return this.pointer>=this.stack.length-1?e:(this.pointer++,JSON.parse(this.stack[this.pointer]))}constructor(){this.stack=[],this.pointer=-1}}class d{select(e){this.selected=e,this.listeners.forEach(t=>t(e))}clear(){this.selected=null,this.listeners.forEach(e=>e(null))}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}constructor(){this.selected=null,this.listeners=new Set}}class h{setDuration(e){this.activeDuration=new l.A(e)}setAccidental(e){this.activeAccidental=this.activeAccidental===e?0:e}setStringFret(e,t){this.activeString=e,this.activeFret=t}constructor(){this.activeDuration=new l.A("q"),this.override=!1,this.activeAccidental=0,this.activeString=null,this.activeFret=null}}var u=i(73173),g=i(35007),p=i(49576);class m{scheduleSequence(e,t,i){this.events=e,this.onPlayheadUpdate=t,this.onEvent=i,this.startTime=this.ctx.currentTime,this.nextEventIndex=0,this.timer=setInterval(()=>this.tick(),500*this.lookahead)}tick(){let e=this.ctx.currentTime-this.startTime;for(;this.nextEventIndex<this.events.length&&this.events[this.nextEventIndex].time<e+this.lookahead;){let e=this.events[this.nextEventIndex];this.onEvent(e),this.nextEventIndex++,this.onPlayheadUpdate(e.beat)}this.nextEventIndex>=this.events.length&&clearInterval(this.timer)}seek(e){this.startTime=this.ctx.currentTime-e}clear(){this.timer&&clearInterval(this.timer),this.events=[]}constructor(e){this.ctx=e,this.events=[],this.lookahead=.1,this.timer=null,this.onPlayheadUpdate=null}}var x=i(53919),f=i.n(x);class v{async load(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"acoustic_grand_piano";if(this.instruments.has(e)){this.currentInstrument=this.instruments.get(e);return}let t=await f().instrument(this.ctx,e);this.instruments.set(e,t),this.currentInstrument=t}play(e,t){let{gain:i=1,duration:n=1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.currentInstrument&&this.currentInstrument.play(e,t,{gain:i,duration:n})}constructor(e){this.ctx=e,this.instruments=new Map,this.currentInstrument=null}}class A{createTrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.ctx.createGain();t.gain.value=e,t.connect(this.master);let i={gain:t,muted:!1,solo:!1};return this.tracks.push(i),i}mute(e){this.tracks[e].muted=!0,this.update()}unmute(e){this.tracks[e].muted=!1,this.update()}solo(e){this.tracks.forEach((t,i)=>t.solo=i===e),this.update()}unsolo(e){this.tracks[e].solo=!1,this.update()}update(){let e=this.tracks.some(e=>e.solo);this.tracks.forEach(t=>{e?t.gain.gain.value=+!!t.solo:t.gain.gain.value=+!t.muted})}constructor(e,t=1){this.ctx=e,this.master=this.ctx.createGain(),this.master.gain.value=t,this.master.connect(this.ctx.destination),this.tracks=[]}}class b{static scoreToEvents(e,t){let i=[],n=0;return e.measures.forEach(e=>{let s=n;e.voices.forEach(e=>{let r=s;e.elements.forEach(e=>{var n,s;null!=e.pitch&&i.push({time:r*t,midi:e.pitch.midi,duration:e.duration.total*t,velocity:.9,beat:r});let a=null!=(s=null==(n=e.duration)?void 0:n.total)?s:1;r+=a}),n=Math.max(n,r)})}),i.sort((e,t)=>e.time-t.time)}}class S{_initIfNeeded(){if(this.ctx)return;let e=window.AudioContext||window.webkitAudioContext;this.ctx=new e,this.mixer=new A(this.ctx,this.masterVolume),this.instrumentManager=new v(this.ctx),this.scheduler=new m(this.ctx)}setTempo(e){this.bpm=e,this.secondsPerBeat=60/e}setLoop(e,t){this.loop={start:e,end:t}}clearLoop(){this.loop=null}async playScore(e){if(this._initIfNeeded(),!this.ctx||!e)return;await this.instrumentManager.load("acoustic_guitar_nylon");let t=b.scoreToEvents(e,this.secondsPerBeat);this.isPlaying=!0,this.playheadBeat=0,this.scheduler.scheduleSequence(t,e=>{this.playheadBeat=e,this.loop&&e>=this.loop.end&&this.scheduler.seek(this.loop.start*this.secondsPerBeat)},e=>{this.instrumentManager.play(e.midi,e.time,{gain:e.velocity,duration:e.duration})}),this._startCursorLoop()}stop(){var e;this.ctx&&(this._stopCursorLoop(),null==(e=this.scheduler)||e.clear(),this.isPlaying=!1,this.playheadBeat=0,this.onBeat&&this.onBeat(0))}_startCursorLoop(){let e=()=>{if(!this.isPlaying||!this.ctx||!this.scheduler)return;let t=(this.ctx.currentTime-this.scheduler.startTime)/this.secondsPerBeat;this.onBeat&&this.onBeat(t),this.rafId=requestAnimationFrame(e)};this._stopCursorLoop(),this.rafId=requestAnimationFrame(e)}_stopCursorLoop(){this.rafId&&cancelAnimationFrame(this.rafId)}constructor({bpm:e=120,masterVolume:t=.9}={}){this.ctx=null,this.instrumentManager=null,this.mixer=null,this.scheduler=null,this.bpm=e,this.masterVolume=t,this.secondsPerBeat=60/e,this.isPlaying=!1,this.playheadBeat=0,this.loop=null,this.onBeat=null,this.rafId=null}}let y=(0,s.createContext)(null);function j(e){let{children:t}=e,[m,x]=(0,s.useState)(null),[f,v]=(0,s.useState)(0),A=(0,s.useRef)(new c),b=(0,s.useRef)(new d),j=(0,s.useRef)(new h),w=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(!m){let e=new r.A({title:"Untitled",composer:"Anonymous",timeSignature:new u.A(4,4),keySignature:new g.A("C"),clef:new p.A("treble")});e.addMeasure(),x(e)}},[]),(0,s.useEffect)(()=>{let e=()=>{w.current||(w.current=new S)};return window.addEventListener("click",e,{once:!0}),()=>window.removeEventListener("click",e)},[]),(0,s.useEffect)(()=>{let e=e=>v(t=>Math.max(0,t+(e.detail||0)));return window.addEventListener("editor:move-cursor",e),()=>window.removeEventListener("editor:move-cursor",e)},[]);let k=e=>{m&&(A.current.snapshot(m),x(t=>{let i=t.clone();return e(i),i}))};return(0,n.jsx)(y.Provider,{value:{score:m,setScore:x,updateScore:k,cursorBeat:f,setCursorBeat:v,undo:A.current,selection:b.current,input:j.current,playback:w.current,addNoteFromFretboard:e=>{var t,i,n,s,r;if(!m||!e||"note"!==e.type||!e.pitch)return;let c=e.pitch,d=new o.A(c.step.toUpperCase(),"#"===c.accidental?1:"b"===c.accidental?-1:0,c.octave),h=j.current.activeDuration||new l.A("q",1),u=new a.A(d,h);u.midi=c.midi,u.velocity=null!=(n=e.velocity)?n:.9,u.fret=null!=(s=null==(t=e.guitar)?void 0:t.fret)?s:0,u.string=null!=(r=null==(i=e.guitar)?void 0:i.string)?r:1,k(e=>{e.addNote(f,u)}),v(e=>e+1)},insertNoteFromStringFret:(e,t)=>{if(!m)return;let{getPitchFromStringFret:n,getMidiFromStringFret:s}=i(50684),r=i(95386).A,o=n(e,t,r.tuning,j.current.activeAccidental),c=s(e,t,r.tuning),d=j.current.activeDuration||new l.A("q",1),h=new a.A(o,d);h.midi=c,h.velocity=.9,h.string=e,h.fret=t,k(e=>{e.addNote(f,h)}),v(e=>e+1)},undoAction:()=>{if(!m)return;let e=m.serialize(),t=A.current.undo(e);t&&x(r.A.deserialize(t))},redoAction:()=>{if(!m)return;let e=m.serialize(),t=A.current.redo(e);t&&x(r.A.deserialize(t))},deleteNote:e=>{k(t=>{t.measures.forEach(t=>{t.voices.forEach(t=>{let i=t.elements.findIndex(t=>t.note&&t.note.id===e.id);-1!==i&&t.elements.splice(i,1)})})})}},children:t})}let w=()=>(0,s.useContext)(y)},56062:(e,t,i)=>{i.d(t,{A:()=>l});var n=i(28044),s=i(73173),r=i(35007),a=i(49576);class l{addMeasure(){let e=new n.A(this.measures.length,this.timeSignature.clone());return e.keySignature=this.keySignature.clone(),e.clef=this.clef.clone(),e.addVoice(),this.measures.push(e),e}addNote(e,t){let i=this.timeSignature.beats,n=Math.floor(e/i);for(;this.measures.length<=n;)this.addMeasure();this.measures[n].voices[0].addNote(e%i,t)}serialize(){return{title:this.title,composer:this.composer,timeSignature:this.timeSignature.serialize(),keySignature:this.keySignature.serialize(),clef:this.clef.serialize(),measures:this.measures.map(e=>e.serialize())}}static deserialize(e){let t=new l;return t.title=e.title||"",t.composer=e.composer||"",t.timeSignature=s.A.deserialize(e.timeSignature),t.keySignature=r.A.deserialize(e.keySignature),t.clef=a.A.deserialize(e.clef),t.measures=e.measures.map(e=>n.A.deserialize(e)),t}clone(){return l.deserialize(this.serialize())}constructor(){this.title="",this.composer="",this.timeSignature=new s.A(4,4),this.keySignature=new r.A("C"),this.clef=new a.A("treble"),this.measures=[]}}},58271:(e,t,i)=>{i.d(t,{A:()=>a});var n=i(37876),s=i(77328),r=i.n(s);function a(e){let{title:t,description:i}=e;return(0,n.jsxs)(r(),{children:[(0,n.jsx)("title",{children:t}),(0,n.jsx)("meta",{name:"format-detection",content:"telephone=no, date=no, email=no, address=no"}),(0,n.jsx)("meta",{name:"keywords",content:"keys, sharps, scales, modes, arpeggios, C major, G major, D major, A major, E major, B major, F# major, C# major, F major, Bb major, Eb major, Ab major, Db major, Gb major, Cb major, natural minor, harmonic minor, melodic minor, dorian, phrygian, lydian, mixolydian, aeolian, locrian, major arpeggios, minor arpeggios, diminished arpeggios, augmented arpeggios"}),(0,n.jsx)("meta",{name:"description",content:i}),(0,n.jsx)("meta",{name:"google-site-verification",content:"GQGKnHaUEkE-5vnOkOETGkV7Rv6kT04U0genM-BeHqQ"})]})}},59100:(e,t,i)=>{i.d(t,{A:()=>n});class n{static toBeats(e){switch(e){case"w":return 4;case"h":return 2;case"q":default:return 1;case"8":return .5;case"16":return .25}}toVexflow(){return this.symbol}clone(){return new n(this.symbol)}serialize(){return{symbol:this.symbol}}static deserialize(e){return new n(e&&"object"==typeof e?e.symbol:"q")}constructor(e="q"){this.symbol=e,this.total=n.toBeats(e)}}},61302:(e,t,i)=>{i.d(t,{A:()=>s});let n={C:0,D:2,E:4,F:5,G:7,A:9,B:11};class s{toMidi(){let e=n[this.step]+this.alter;return(this.octave+1)*12+e}static fromMidi(e){let t=Math.floor(e/12)-1,i=e%12,r=Object.entries(n),a="C",l=0;for(let[e,t]of r){if(t===i){a=e,l=0;break}t===i-1&&(a=e,l=1)}return new s(a,l,t)}clone(){return new s(this.step,this.alter,this.octave)}serialize(){return{step:this.step,alter:this.alter,octave:this.octave}}static deserialize(e){return e&&"object"==typeof e?new s(e.step,e.alter,e.octave):new s("C",0,4)}constructor(e="C",t=0,i=4){this.step=e,this.alter=t,this.octave=i}}},73173:(e,t,i)=>{i.d(t,{A:()=>n});class n{toString(){return"".concat(this.beats,"/").concat(this.beatValue)}clone(){return new n(this.beats,this.beatValue)}serialize(){return{beats:this.beats,beatValue:this.beatValue}}static deserialize(e){return new n(e.beats,e.beatValue)}constructor(e=4,t=4){this.beats=e,this.beatValue=t}}}}]);